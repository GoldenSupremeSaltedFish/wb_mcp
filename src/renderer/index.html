<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®åš MCP é…ç½®ç®¡ç†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #e74c3c;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 14px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .card h2 {
            margin-bottom: 15px;
            color: #333;
            font-size: 18px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group textarea {
            height: 100px;
            resize: vertical;
        }
        
        .form-group small {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
            display: block;
        }
        
        .button {
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .button:hover {
            background: #c0392b;
        }
        
        .button.secondary {
            background: #6c757d;
        }
        
        .button.secondary:hover {
            background: #545b62;
        }
        
        .button.success {
            background: #28a745;
        }
        
        .button.success:hover {
            background: #1e7e34;
        }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            border-bottom-color: #e74c3c;
            color: #e74c3c;
            font-weight: 500;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .service-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .status-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
        }
        
        .status-item .icon {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .status-item .label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .status-item .value {
            font-size: 16px;
            font-weight: 500;
        }
        
        .log-container {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-entry.error {
            color: #dc3545;
        }
        
        .log-entry.warn {
            color: #ffc107;
        }
        
        .log-entry.info {
            color: #17a2b8;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦ å¾®åš MCP é…ç½®ç®¡ç†</h1>
            <p>ç®¡ç†å¾®åš MCP æœåŠ¡çš„é…ç½®ã€ç›‘æ§æœåŠ¡çŠ¶æ€å’ŒæŸ¥çœ‹æ—¥å¿—</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('config')">é…ç½®ç®¡ç†</div>
            <div class="tab" onclick="showTab('status')">æœåŠ¡çŠ¶æ€</div>
            <div class="tab" onclick="showTab('logs')">æ—¥å¿—æŸ¥çœ‹</div>
            <div class="tab" onclick="showTab('tools')">å·¥å…·æµ‹è¯•</div>
        </div>
        
        <!-- é…ç½®ç®¡ç†æ ‡ç­¾é¡µ -->
        <div id="config" class="tab-content active">
            <div class="card">
                <h2>å¾®åšè®¤è¯é…ç½®</h2>
                <div id="config-status"></div>
                
                <div class="form-group">
                    <label for="access-token">Access Token</label>
                    <input type="password" id="access-token" placeholder="è¾“å…¥å¾®åš Access Token">
                    <small>ä»å¾®åšå¼€å‘è€…å¹³å°è·å–çš„è®¿é—®ä»¤ç‰Œ</small>
                </div>
                
                <div class="form-group">
                    <label for="cookie">Cookie</label>
                    <textarea id="cookie" placeholder="è¾“å…¥å¾®åš Cookie å­—ç¬¦ä¸²"></textarea>
                    <small>ä»æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­å¤åˆ¶çš„ Cookie å€¼</small>
                </div>
                
                <div class="form-group">
                    <label for="user-agent">User Agent</label>
                    <input type="text" id="user-agent" placeholder="æµè§ˆå™¨ User Agent">
                    <small>æ¨¡æ‹Ÿçš„æµè§ˆå™¨æ ‡è¯†ï¼Œç”¨äºé¿å…æ£€æµ‹</small>
                </div>
                
                <button class="button" onclick="saveConfig()">ä¿å­˜é…ç½®</button>
                <button class="button secondary" onclick="loadConfig()">é‡æ–°åŠ è½½</button>
                <button class="button secondary" onclick="testConnection()">æµ‹è¯•è¿æ¥</button>
            </div>
            
            <div class="card">
                <h2>æœåŠ¡é…ç½®</h2>
                
                <div class="form-group">
                    <label for="mcp-port">MCP æœåŠ¡ç«¯å£</label>
                    <input type="number" id="mcp-port" placeholder="3000">
                    <small>MCP æœåŠ¡ç›‘å¬çš„ç«¯å£å·</small>
                </div>
                
                <div class="form-group">
                    <label for="rate-limit">è¯·æ±‚é¢‘ç‡é™åˆ¶</label>
                    <input type="number" id="rate-limit" placeholder="10">
                    <small>æ¯ç§’æœ€å¤§è¯·æ±‚æ¬¡æ•°</small>
                </div>
                
                <div class="form-group">
                    <label for="request-interval">è¯·æ±‚é—´éš” (æ¯«ç§’)</label>
                    <input type="number" id="request-interval" placeholder="1000">
                    <small>è¯·æ±‚ä¹‹é—´çš„æœ€å°é—´éš”æ—¶é—´</small>
                </div>
                
                <button class="button" onclick="saveServiceConfig()">ä¿å­˜æœåŠ¡é…ç½®</button>
            </div>
            
            <div class="card">
                <h2>æ•°æ®å­˜å‚¨é…ç½®</h2>
                
                <div class="form-group">
                    <label for="data-dir">æ•°æ®ç›®å½•</label>
                    <input type="text" id="data-dir" placeholder="./data">
                    <small>å­˜å‚¨é‡‡é›†æ•°æ®çš„ç›®å½•è·¯å¾„</small>
                </div>
                
                <div class="form-group">
                    <label for="export-dir">å¯¼å‡ºç›®å½•</label>
                    <input type="text" id="export-dir" placeholder="./exports">
                    <small>å¯¼å‡ºæ–‡ä»¶çš„ä¿å­˜ç›®å½•</small>
                </div>
                
                <div class="form-group">
                    <label for="log-level">æ—¥å¿—çº§åˆ«</label>
                    <select id="log-level">
                        <option value="debug">Debug</option>
                        <option value="info" selected>Info</option>
                        <option value="warn">Warn</option>
                        <option value="error">Error</option>
                    </select>
                    <small>æ—¥å¿—è®°å½•çš„è¯¦ç»†ç¨‹åº¦</small>
                </div>
                
                <button class="button" onclick="saveStorageConfig()">ä¿å­˜å­˜å‚¨é…ç½®</button>
            </div>
        </div>
        
        <!-- æœåŠ¡çŠ¶æ€æ ‡ç­¾é¡µ -->
        <div id="status" class="tab-content">
            <div class="card">
                <h2>æœåŠ¡çŠ¶æ€</h2>
                <div class="service-status">
                    <div class="status-item">
                        <div class="icon">ğŸŒ</div>
                        <div class="label">MCP æœåŠ¡</div>
                        <div class="value" id="mcp-status">æ£€æŸ¥ä¸­...</div>
                    </div>
                    <div class="status-item">
                        <div class="icon">ğŸ”</div>
                        <div class="label">è®¤è¯çŠ¶æ€</div>
                        <div class="value" id="auth-status">æ£€æŸ¥ä¸­...</div>
                    </div>
                    <div class="status-item">
                        <div class="icon">â°</div>
                        <div class="label">ä»»åŠ¡è°ƒåº¦å™¨</div>
                        <div class="value" id="scheduler-status">æ£€æŸ¥ä¸­...</div>
                    </div>
                    <div class="status-item">
                        <div class="icon">ğŸŒ</div>
                        <div class="label">æµè§ˆå™¨</div>
                        <div class="value" id="browser-status">æ£€æŸ¥ä¸­...</div>
                    </div>
                </div>
                
                <button class="button" onclick="refreshStatus()">åˆ·æ–°çŠ¶æ€</button>
                <button class="button secondary" onclick="startService()">å¯åŠ¨æœåŠ¡</button>
                <button class="button secondary" onclick="stopService()">åœæ­¢æœåŠ¡</button>
            </div>
            
            <div class="card">
                <h2>ä»»åŠ¡è°ƒåº¦å™¨çŠ¶æ€</h2>
                <div id="task-status"></div>
                <button class="button" onclick="refreshTaskStatus()">åˆ·æ–°ä»»åŠ¡çŠ¶æ€</button>
            </div>
        </div>
        
        <!-- æ—¥å¿—æŸ¥çœ‹æ ‡ç­¾é¡µ -->
        <div id="logs" class="tab-content">
            <div class="card">
                <h2>å®æ—¶æ—¥å¿—</h2>
                <div class="log-container" id="log-container">
                    <div class="log-entry info">ç­‰å¾…æ—¥å¿—è¾“å‡º...</div>
                </div>
                <button class="button" onclick="clearLogs()">æ¸…ç©ºæ—¥å¿—</button>
                <button class="button secondary" onclick="exportLogs()">å¯¼å‡ºæ—¥å¿—</button>
            </div>
        </div>
        
        <!-- å·¥å…·æµ‹è¯•æ ‡ç­¾é¡µ -->
        <div id="tools" class="tab-content">
            <div class="card">
                <h2>å·¥å…·æµ‹è¯•</h2>
                
                <div class="form-group">
                    <label for="test-tool">é€‰æ‹©å·¥å…·</label>
                    <select id="test-tool" onchange="updateToolParams()">
                        <option value="">è¯·é€‰æ‹©å·¥å…·</option>
                        <option value="search_posts">æœç´¢å¾®åš</option>
                        <option value="get_hot_topics">è·å–çƒ­æœæ¦œ</option>
                        <option value="get_comments">è·å–è¯„è®º</option>
                        <option value="get_status">è·å–çŠ¶æ€</option>
                        <option value="task_scheduler">ä»»åŠ¡è°ƒåº¦å™¨</option>
                    </select>
                </div>
                
                <div id="tool-params"></div>
                
                <button class="button" onclick="testTool()">æ‰§è¡Œæµ‹è¯•</button>
                <button class="button secondary" onclick="clearTestResult()">æ¸…ç©ºç»“æœ</button>
                
                <div id="test-result" class="hidden">
                    <h3>æµ‹è¯•ç»“æœ</h3>
                    <pre id="test-output"></pre>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // æ ¹æ®æ ‡ç­¾é¡µåŠ è½½ç›¸åº”æ•°æ®
            if (tabName === 'status') {
                refreshStatus();
            } else if (tabName === 'logs') {
                startLogStream();
            }
        }
        
        // é…ç½®ç®¡ç†
        function saveConfig() {
            const config = {
                accessToken: document.getElementById('access-token').value,
                cookie: document.getElementById('cookie').value,
                userAgent: document.getElementById('user-agent').value
            };
            
            // è¿™é‡Œåº”è¯¥è°ƒç”¨ä¸»è¿›ç¨‹ä¿å­˜é…ç½®
            showStatus('é…ç½®ä¿å­˜æˆåŠŸ', 'success');
        }
        
        function loadConfig() {
            // è¿™é‡Œåº”è¯¥ä»ä¸»è¿›ç¨‹åŠ è½½é…ç½®
            showStatus('é…ç½®åŠ è½½æˆåŠŸ', 'success');
        }
        
        function testConnection() {
            showStatus('æ­£åœ¨æµ‹è¯•è¿æ¥...', 'info');
            // è¿™é‡Œåº”è¯¥è°ƒç”¨ä¸»è¿›ç¨‹æµ‹è¯•è¿æ¥
            setTimeout(() => {
                showStatus('è¿æ¥æµ‹è¯•å®Œæˆ', 'success');
            }, 2000);
        }
        
        function saveServiceConfig() {
            const config = {
                port: document.getElementById('mcp-port').value,
                rateLimit: document.getElementById('rate-limit').value,
                requestInterval: document.getElementById('request-interval').value
            };
            
            showStatus('æœåŠ¡é…ç½®ä¿å­˜æˆåŠŸ', 'success');
        }
        
        function saveStorageConfig() {
            const config = {
                dataDir: document.getElementById('data-dir').value,
                exportDir: document.getElementById('export-dir').value,
                logLevel: document.getElementById('log-level').value
            };
            
            showStatus('å­˜å‚¨é…ç½®ä¿å­˜æˆåŠŸ', 'success');
        }
        
        // çŠ¶æ€ç®¡ç†
        function refreshStatus() {
            // æ¨¡æ‹ŸçŠ¶æ€æ£€æŸ¥
            document.getElementById('mcp-status').textContent = 'è¿è¡Œä¸­';
            document.getElementById('auth-status').textContent = 'å·²è®¤è¯';
            document.getElementById('scheduler-status').textContent = 'è¿è¡Œä¸­';
            document.getElementById('browser-status').textContent = 'å°±ç»ª';
        }
        
        function refreshTaskStatus() {
            const taskStatus = document.getElementById('task-status');
            taskStatus.innerHTML = `
                <div class="status info">
                    <strong>å®šæ—¶æ‹‰å–çƒ­æœæ¦œ:</strong> å¯ç”¨ (ä¸‹æ¬¡è¿è¡Œ: 5åˆ†é’Ÿå)<br>
                    <strong>æ£€æŸ¥è®¤è¯çŠ¶æ€:</strong> å¯ç”¨ (ä¸‹æ¬¡è¿è¡Œ: 1å°æ—¶å)<br>
                    <strong>æ¸…ç†æ—§æ—¥å¿—:</strong> å¯ç”¨ (ä¸‹æ¬¡è¿è¡Œ: 24å°æ—¶å)
                </div>
            `;
        }
        
        // æ—¥å¿—ç®¡ç†
        function startLogStream() {
            const logContainer = document.getElementById('log-container');
            // æ¨¡æ‹Ÿæ—¥å¿—æµ
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry info';
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] æ—¥å¿—æµå·²å¯åŠ¨`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        function clearLogs() {
            document.getElementById('log-container').innerHTML = '<div class="log-entry info">æ—¥å¿—å·²æ¸…ç©º</div>';
        }
        
        function exportLogs() {
            showStatus('æ—¥å¿—å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }
        
        // å·¥å…·æµ‹è¯•
        function updateToolParams() {
            const tool = document.getElementById('test-tool').value;
            const paramsDiv = document.getElementById('tool-params');
            
            let paramsHTML = '';
            switch (tool) {
                case 'search_posts':
                    paramsHTML = `
                        <div class="form-group">
                            <label for="search-keyword">æœç´¢å…³é”®è¯</label>
                            <input type="text" id="search-keyword" placeholder="è¾“å…¥æœç´¢å…³é”®è¯">
                        </div>
                        <div class="form-group">
                            <label for="search-limit">ç»“æœæ•°é‡</label>
                            <input type="number" id="search-limit" value="10">
                        </div>
                    `;
                    break;
                case 'get_hot_topics':
                    paramsHTML = `
                        <div class="form-group">
                            <label for="topics-limit">è¯é¢˜æ•°é‡</label>
                            <input type="number" id="topics-limit" value="20">
                        </div>
                    `;
                    break;
                case 'get_comments':
                    paramsHTML = `
                        <div class="form-group">
                            <label for="post-id">å¾®åš ID</label>
                            <input type="text" id="post-id" placeholder="è¾“å…¥å¾®åš ID">
                        </div>
                        <div class="form-group">
                            <label for="comments-limit">è¯„è®ºæ•°é‡</label>
                            <input type="number" id="comments-limit" value="10">
                        </div>
                    `;
                    break;
            }
            
            paramsDiv.innerHTML = paramsHTML;
        }
        
        function testTool() {
            const tool = document.getElementById('test-tool').value;
            if (!tool) {
                showStatus('è¯·å…ˆé€‰æ‹©è¦æµ‹è¯•çš„å·¥å…·', 'error');
                return;
            }
            
            showStatus('æ­£åœ¨æ‰§è¡Œæµ‹è¯•...', 'info');
            
            // æ¨¡æ‹Ÿå·¥å…·æ‰§è¡Œ
            setTimeout(() => {
                const result = {
                    success: true,
                    data: `æµ‹è¯•å·¥å…· ${tool} æ‰§è¡ŒæˆåŠŸ`,
                    timestamp: new Date().toISOString()
                };
                
                document.getElementById('test-output').textContent = JSON.stringify(result, null, 2);
                document.getElementById('test-result').classList.remove('hidden');
                showStatus('å·¥å…·æµ‹è¯•å®Œæˆ', 'success');
            }, 2000);
        }
        
        function clearTestResult() {
            document.getElementById('test-result').classList.add('hidden');
            document.getElementById('test-output').textContent = '';
        }
        
        // å·¥å…·å‡½æ•°
        function showStatus(message, type) {
            const statusDiv = document.getElementById('config-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 3000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadConfig();
            refreshStatus();
            refreshTaskStatus();
        });
    </script>
</body>
</html>
